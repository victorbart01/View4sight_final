{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["file:///Users/victorbarthelemy/Documents/GitHub/View4Sight-final/View4sight_final/lib/polar.js"],"sourcesContent":["import { Polar } from \"@polar-sh/sdk\";\n\nexport const polar = new Polar({\n  accessToken: process.env.POLAR_ACCESS_TOKEN,\n  server: process.env.POLAR_SERVER || \"sandbox\", // Use sandbox by default, change to \"production\" for live\n}); "],"names":[],"mappings":";;;AAAA;AAAA;;AAEO,MAAM,QAAQ,IAAI,mKAAA,CAAA,QAAK,CAAC;IAC7B,aAAa,QAAQ,GAAG,CAAC,kBAAkB;IAC3C,QAAQ,QAAQ,GAAG,CAAC,YAAY,IAAI;AACtC"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///Users/victorbarthelemy/Documents/GitHub/View4Sight-final/View4sight_final/app/api/create-checkout/route.js"],"sourcesContent":["import { polar } from \"@/lib/polar\";\nimport { NextResponse } from \"next/server\";\n\nexport async function POST(request) {\n  try {\n    // Debug des variables d'environnement\n    console.log(\"=== DEBUG INFO ===\");\n    console.log(\"Has token:\", !!process.env.POLAR_ACCESS_TOKEN);\n    console.log(\"Token length:\", process.env.POLAR_ACCESS_TOKEN?.length || 0);\n    console.log(\"Server config:\", process.env.POLAR_SERVER);\n    console.log(\"Base URL:\", process.env.NEXT_PUBLIC_BASE_URL);\n    \n    const { productId, planName, isYearly } = await request.json();\n    console.log(\"Received data:\", { productId, planName, isYearly });\n\n    if (!productId) {\n      return NextResponse.json(\n        { error: \"Product ID is required\" },\n        { status: 400 }\n      );\n    }\n\n    console.log(\"Creating checkout for product:\", productId);\n\n    // Create checkout session with Polar\n    const checkout = await polar.checkouts.create({\n      products: [productId],\n      successUrl: `${process.env.NEXT_PUBLIC_BASE_URL || \"http://localhost:3000\"}/confirmation?checkout_id={CHECKOUT_ID}&plan=${planName}&billing=${isYearly ? \"yearly\" : \"monthly\"}`,\n      metadata: {\n        plan_name: planName,\n        billing_cycle: isYearly ? \"yearly\" : \"monthly\",\n        source: \"view4sight_website\"\n      }\n    });\n\n    console.log(\"Checkout created successfully:\", checkout.id);\n    return NextResponse.json({ checkoutUrl: checkout.url });\n  } catch (error) {\n    console.error(\"=== ERROR DETAILS ===\");\n    console.error(\"Error message:\", error.message);\n    console.error(\"Error stack:\", error.stack);\n    console.error(\"Full error:\", error);\n    \n    // Check if it's an authentication error\n    if (error.message?.includes('401') || error.message?.includes('invalid_token')) {\n      return NextResponse.json(\n        { \n          error: \"Authentication failed - check your Polar access token\",\n          details: error.message,\n          hasToken: !!process.env.POLAR_ACCESS_TOKEN,\n          tokenLength: process.env.POLAR_ACCESS_TOKEN?.length || 0,\n          suggestion: \"Make sure your .env.local file exists and contains a valid POLAR_ACCESS_TOKEN\"\n        },\n        { status: 401 }\n      );\n    }\n    \n    return NextResponse.json(\n      { \n        error: \"Failed to create checkout session\",\n        details: error.message,\n        hasToken: !!process.env.POLAR_ACCESS_TOKEN,\n        productId: productId\n      },\n      { status: 500 }\n    );\n  }\n} "],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,sCAAsC;QACtC,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,cAAc,CAAC,CAAC,QAAQ,GAAG,CAAC,kBAAkB;QAC1D,QAAQ,GAAG,CAAC,iBAAiB,QAAQ,GAAG,CAAC,kBAAkB,EAAE,UAAU;QACvE,QAAQ,GAAG,CAAC,kBAAkB,QAAQ,GAAG,CAAC,YAAY;QACtD,QAAQ,GAAG,CAAC;QAEZ,MAAM,EAAE,WAAA,UAAS,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAC5D,QAAQ,GAAG,CAAC,kBAAkB;YAAE,WAAA;YAAW;YAAU;QAAS;QAE9D,IAAI,CAAC,YAAW;YACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAyB,GAClC;gBAAE,QAAQ;YAAI;QAElB;QAEA,QAAQ,GAAG,CAAC,kCAAkC;QAE9C,qCAAqC;QACrC,MAAM,WAAW,MAAM,8GAAA,CAAA,QAAK,CAAC,SAAS,CAAC,MAAM,CAAC;YAC5C,UAAU;gBAAC;aAAU;YACrB,YAAY,GAAG,6DAAoC,wBAAwB,6CAA6C,EAAE,SAAS,SAAS,EAAE,WAAW,WAAW,WAAW;YAC/K,UAAU;gBACR,WAAW;gBACX,eAAe,WAAW,WAAW;gBACrC,QAAQ;YACV;QACF;QAEA,QAAQ,GAAG,CAAC,kCAAkC,SAAS,EAAE;QACzD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,aAAa,SAAS,GAAG;QAAC;IACvD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC;QACd,QAAQ,KAAK,CAAC,kBAAkB,MAAM,OAAO;QAC7C,QAAQ,KAAK,CAAC,gBAAgB,MAAM,KAAK;QACzC,QAAQ,KAAK,CAAC,eAAe;QAE7B,wCAAwC;QACxC,IAAI,MAAM,OAAO,EAAE,SAAS,UAAU,MAAM,OAAO,EAAE,SAAS,kBAAkB;YAC9E,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,SAAS,MAAM,OAAO;gBACtB,UAAU,CAAC,CAAC,QAAQ,GAAG,CAAC,kBAAkB;gBAC1C,aAAa,QAAQ,GAAG,CAAC,kBAAkB,EAAE,UAAU;gBACvD,YAAY;YACd,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,MAAM,OAAO;YACtB,UAAU,CAAC,CAAC,QAAQ,GAAG,CAAC,kBAAkB;YAC1C,WAAW;QACb,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}